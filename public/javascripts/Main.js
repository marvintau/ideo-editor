!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return t.match(/[ @]/)?'"'+t+'"':t}function s(t,e){return(0==e?"@ ":"  ")+t}function r(t,e){return(0==e?"# ":"  ")+t}function o(t,e,i,s){var o=Object.keys(t),l=o.map(n=>({key:n,val:e(t[n],i-n.length,s)})),a=l.map(t=>t.val.some(t=>t.includes("@")||t.includes("#"))).some(t=>t),h=l.map(t=>n(t.key)+": "+t.val[0]).join(" "),c=a||h.length>i,u=l.map(t=>t.val.map((e,i)=>(function(t,e,i){var s=n(i);return(0==e?s+": ":" ".repeat(s.length+2))+t})(e,i,t.key))).flat(),d=u.some(t=>t.length>s),p=o.map(n=>({key:n,val:e(t[n],i-2,s)})).map(t=>(function(t,e){return[e+":"].concat(t.map(t=>" "+t))})(t.val,t.key)).flat();return d?p.map(r):c?u.map(r):["# "+h]}function l(t,e,i){switch(typeof t){case"string":return[n(t)];case"number":return[t%1==0?t.toString():t.toFixed(3)];case"object":return Array.isArray(t)?function(t,e,i){var n=t.map(t=>e(t,i-2)).flat(),r=n.join(" ");return n.some(t=>t.includes("@")||t.includes("#"))||r.length>i?n.map(s):["@ "+r]}(t,l,e):o(t,l,e,i)}}function a(t){return{"{":"}","[":"]",":":""}[t[t.length-1].type]}function h(t,e,i){return t.split("\n").map(t=>t.replace(/(\S+\s*)(?=:)/g,'<b class="'+e+'">$1</b>').replace(/([#@:])/g,'<b class="'+i+'">$1</b>')).join("\n")}i.r(e);class c{constructor(t,e,i){void 0===i?(this.attr={},void 0===e?void 0===t?(this.x=0,this.y=0):void 0!==t.x&&void 0!==t.y?(this.x=t.x,this.y=t.y):void 0!==t.len&&void 0!==t.ang?(this.x=t.len*Math.cos(t.ang*Math.PI/180),this.y=t.len*Math.sin(t.ang*Math.PI/180)):"number"==typeof t&&(this.x=Math.cos(t*Math.PI/180),this.y=Math.sin(t*Math.PI/180)):(this.x=t,this.y=e)):(this.attr=i,this.x=t,this.y=e)}add(t){return new c(this.x+t.x,this.y+t.y)}iadd(t){this.x+=t.x,this.y+=t.y}sub(t){return new c(this.x-t.x,this.y-t.y)}isub(t){this.x-=t.x,this.y-=t.y}mult(t){return void 0===t.x?new c(this.x*t,this.y*t):new c(this.x*t.x,this.y*t.y)}imult(t){void 0===t.x?(this.y*=t,this.x*=t):(this.x*=t.x,this.y*=t.y)}polar(t){return new c(this.x+t.len*Math.cos(t.ang*Math.PI/180),this.y+t.len*Math.sin(t.ang*Math.PI/180))}ipolar(t){this.x+=t.len*Math.cos(t.ang*Math.PI/180),this.y+=t.len*Math.sin(t.ang*Math.PI/180)}iscale(t,e){this.isub(e),this.imult(t),this.iadd(e)}rotate(t){let e=t/180*Math.PI,i=Math.sin(e),n=Math.cos(e);return new c(this.x*n-this.y*i,this.x*i+this.y*n)}irotate(t){let e=this.rotate(t);this.x=e.x,this.y=e.y}neg(){return new c(-this.x,-this.y)}cross(t){return this.x*t.y-t.x*this.y}mag(){return Math.hypot(this.x,this.y)}norm(){return this.mult(1/this.mag())}angle(){return Math.atan2(this.y,this.x)/Math.PI*180}isNaN(){return isNaN(this.x)||isNaN(this.y)}addAttr(t){this.attr.push(t)}setAttr(t){return Object.assign(this.attr,t)}removeAttr(t){this.attr[t]=void 0}copy(){return new c(this.x,this.y,JSON.parse(JSON.stringify(this.attr)))}}new class{constructor(t){this.textStyle={background:"transparent","z-index":2,height:"auto",resize:"none","-webkit-text-fill-color":"transparent",outline:"none"},this.textCodeStyle={position:"absolute",top:"0px",left:0,width:"550px","font-family":'"Inconsolata", "TheSansMono Office", "FiraSans Mono, monospace"',"font-size":"12px","letter-spacing":"-0.05em","line-height":"150%",padding:"10px",resize:"none",border:"none","border-radius":"5px","overflow-x":"scroll","overflow-y":"scroll"},this.edit=document.createElement("textarea"),this.edit.setAttribute("id","textedit"),this.edit.setAttribute("spellcheck","false"),this.edit.setAttribute("class","editor");for(let t in this.textStyle)this.edit.style[t]=this.textStyle[t];for(let t in this.textCodeStyle)this.edit.style[t]=this.textCodeStyle[t];t.appendChild(this.edit),this.preStyle={"white-space":"pre-wrap","word-wrap":"break-word"},this.codeStyle={background:"#fdf6e3","z-index":1};let e=document.createElement("pre");this.disp=document.createElement("code"),this.disp.setAttribute("id","textdisp"),this.disp.setAttribute("class","editor editor-display"),e.appendChild(this.disp),t.appendChild(e);for(let t in this.preStyle)e.style[t]=this.preStyle[t];for(let t in this.textCodeStyle)this.disp.style[t]=this.textCodeStyle[t];for(let t in this.codeStyle)this.disp.style[t]=this.codeStyle[t];this.init()}init(){window.addEventListener("keydown",function(t){var e,i,n,s,r,o;if("Tab"===t.key&&(t.preventDefault(),this.edit.value.split("\n"),e=this.edit,i="  ",r=e.value,o=e.ownerDocument,"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?(n=e.selectionEnd,e.value=r.slice(0,n)+i+r.slice(n),e.selectionStart=e.selectionEnd=n+i.length):"undefined"!=o.selection&&o.selection.createRange&&(e.focus(),(s=o.selection.createRange()).collapse(!1),s.text=i,s.select())),"Enter"===t.key&&t.ctrlKey){let e=function(t){var e=t.split("\n").filter(t=>!t.match(/^\s*$/)),i="",n=[],s=0;for(let t=0;t<e.length;t++){for(var r=e[t].search(/\S|$/);n.length>0&&n[n.length-1].indent>=r;)i+=a(n),n.pop();s=0;for(var o=e[t];o.length>0;)switch(o[0]){case" ":n[n.length-1].comma?i+=", ":n[n.length-1].comma=!0,s+=o.search(/\S|$/),o=o.trim();break;case"@":i+="[",n.push({type:"[",indent:s,comma:!1}),s+=1,o=o.slice(1);break;case"#":i+="{",n.push({type:"{",indent:s,comma:!1}),s+=1,o=o.slice(1);break;case":":i+=":",n.push({type:":",indent:s}),s+=1,o=o.slice(1);break;case'"':var l=o.match(/"(?:\\"|[^"])*"/);if(!l)throw"Quoted string missing at Line: "+t;n.length>0&&":"==n[n.length-1].type&&n.pop(),s+=l[0].length,i+=o.slice(0,l[0].length),o=o.slice(l[0].length);break;default:var h=o.match(/[^\s:]*/);if(!h)throw"Simple string got some problem at Line: 1";n.length>0&&":"==n[n.length-1].type&&n.pop(),s+=h[0].length;var c=o.slice(0,h[0].length),u=parseFloat(c);i+=u||0==u?u:'"'+c+'"',o=o.slice(h[0].length)}}for(;n.length>0&&n[n.length-1].indent>=0;)i+=a(n),n.pop();return i}(this.edit.value),i=JSON.parse(e),n=function(t,e){return l(t,e,e).join("\n")}(i,120);this.edit.value=n,this.edit.focus(),t.target.dispatchEvent(new CustomEvent("interpret",{bubbles:!0,detail:i}))}else"Enter"===t.key&&t.ctrlKey}.bind(this)),this.edit.addEventListener("input",function(t){console.log("yaya"),this.edit.style.height=this.edit.scrollHeight;var e=this.edit.value;this.disp.innerHTML=h(e,"","color:#d33682;")+"\n "}.bind(this)),this.edit.innerText="@ ",this.disp.innerHTML=h("@ ","","color:#d33682;")+"\n ",this.edit.focus()}highlight(){}update(t){this.edit.value=t,this.highlight()}}(document.getElementById("editor"));let u=document.createElement("canvas");function d(t,e,i,n){let s=t.sub(i).cross(i.sub(n)),r=-t.sub(e).cross(t.sub(i)),o=t.sub(e).cross(i.sub(n)),l=s/o,a=r/o;return{p:t.add(e.sub(t).mult(l)),s:l,t:a}}u.width=400,u.height=400,document.getElementById("canvas-container").appendChild(u);class p extends Array{constructor(t){super(...t),this.push(this[0])}splitBy(t){let e=void 0,i=void 0;for(let s=0;s<t.length-1;s++){let r=t[s],o=t[s+1];for(let t=0;t<this.length-1;t++){var n=d(r,o,this[t],this[t+1]);let l=n.t>0&&n.t<1,a=n.s<1&&n.s>0,h=n.s<1&&r.head,c=n.s>0&&o.tail,u=h||a||c;if(l&&u){let r={inter:n,stro:s,poly:t};if(e){if(i)break;i=r}else e=r}}if(void 0!==e&&void 0!==i)break}let s,r,o=[e.inter.p];for(let n=e.stroke+1;n<i.stroke;n++)o.push(t[n]);o.push(i.inter.p),e.polygon<i.polygon?(s=e.polygon,r=i.polygon,o.reverse()):(s=i.polygon,r=e.polygon);let l=Array.from(this),a=l.slice(s,r),h=l.slice(1,r).concat(o.reverse()).concat(l.slice(r));return console.log(l),{i:new p(a),o:new p(h),strokeRef:t}}}let y=new p([new c(1,1),new c(-1,1),new c(-1,-1),new c(1,-1)]),f=new class extends Array{constructor(t){super(...t),this[0].setAttr({head:!0}),this[this.length-1].setAttr({tail:!0})}}([new c(0,2),new c(0,-2)]);console.log(y.splitBy(f)),console.log(y),document.addEventListener("interpret",function(t){console.log(t,"interpret")})}]);