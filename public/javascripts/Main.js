!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(t){return t.match(/[ @]/)?'"'+t+'"':t}function s(t,e){return(0==e?"@ ":"  ")+t}function r(t,e){return(0==e?"# ":"  ")+t}function o(t,e,i,s){var o=Object.keys(t),l=o.map(n=>({key:n,val:e(t[n],i-n.length,s)})),h=l.map(t=>t.val.some(t=>t.includes("@")||t.includes("#"))).some(t=>t),a=l.map(t=>n(t.key)+": "+t.val[0]).join(" "),c=h||a.length>i,d=l.map(t=>t.val.map((e,i)=>(function(t,e,i){var s=n(i);return(0==e?s+": ":" ".repeat(s.length+2))+t})(e,i,t.key))).flat(),u=d.some(t=>t.length>s),p=o.map(n=>({key:n,val:e(t[n],i-2,s)})).map(t=>(function(t,e){return[e+":"].concat(t.map(t=>" "+t))})(t.val,t.key)).flat();return u?p.map(r):c?d.map(r):["# "+a]}function l(t,e,i){switch(typeof t){case"string":return[n(t)];case"number":return[t%1==0?t.toString():t.toFixed(3)];case"object":return Array.isArray(t)?function(t,e,i){var n=t.map(t=>e(t,i-2)).flat(),r=n.join(" ");return n.some(t=>t.includes("@")||t.includes("#"))||r.length>i?n.map(s):["@ "+r]}(t,l,e):o(t,l,e,i)}}function h(t){return{"{":"}","[":"]",":":""}[t[t.length-1].type]}function a(t,e,i){return t.split("\n").map(t=>t.replace(/(\S+\s*)(?=:)/g,'<b class="'+e+'">$1</b>').replace(/([#@:])/g,'<b class="'+i+'">$1</b>')).join("\n")}i.r(e);class c{constructor(t,e,i){void 0===i?(this.attr={},void 0===e?void 0===t?(this.x=0,this.y=0):void 0!==t.x&&void 0!==t.y?(this.x=t.x,this.y=t.y):void 0!==t.len&&void 0!==t.ang?(this.x=t.len*Math.cos(t.ang*Math.PI/180),this.y=t.len*Math.sin(t.ang*Math.PI/180)):"number"==typeof t&&(this.x=Math.cos(t*Math.PI/180),this.y=Math.sin(t*Math.PI/180)):(this.x=t,this.y=e)):(this.attr=i,this.x=t,this.y=e)}add(t){return new c(this.x+t.x,this.y+t.y)}iadd(t){this.x+=t.x,this.y+=t.y}sub(t){return new c(this.x-t.x,this.y-t.y)}isub(t){this.x-=t.x,this.y-=t.y}mult(t){return void 0===t.x?new c(this.x*t,this.y*t):new c(this.x*t.x,this.y*t.y)}imult(t){void 0===t.x?(this.y*=t,this.x*=t):(this.x*=t.x,this.y*=t.y)}polar(t){return new c(this.x+t.len*Math.cos(t.ang*Math.PI/180),this.y+t.len*Math.sin(t.ang*Math.PI/180))}ipolar(t){this.x+=t.len*Math.cos(t.ang*Math.PI/180),this.y+=t.len*Math.sin(t.ang*Math.PI/180)}iscale(t,e){this.isub(e),this.imult(t),this.iadd(e)}rotate(t){let e=t/180*Math.PI,i=Math.sin(e),n=Math.cos(e);return new c(this.x*n-this.y*i,this.x*i+this.y*n)}irotate(t){let e=this.rotate(t);this.x=e.x,this.y=e.y}neg(){return new c(-this.x,-this.y)}cross(t){return this.x*t.y-t.x*this.y}mag(){return Math.hypot(this.x,this.y)}norm(){return this.mult(1/this.mag())}angle(){return Math.atan2(this.y,this.x)/Math.PI*180}isNaN(){return isNaN(this.x)||isNaN(this.y)}addAttr(t){this.attr.push(t)}setAttr(t){return Object.assign(this.attr,t)}removeAttr(t){this.attr[t]=void 0}copy(){return new c(this.x,this.y,JSON.parse(JSON.stringify(this.attr)))}}class d{constructor(t,e,i,n){this.type="Color";const s={plum:[[-.0399966,.0271153,-484974e-9,308273e-10],[-.00588486,.00511731,-405736e-10,7.75887*1e-6],[.00402332,.0015165,220422e-9,1e-5*-1.92692]]};if(void 0!==e&&void 0!==i)this.r=t,this.g=e,this.b=i,this.a=n;else{const e=void 0!==t?s[t.scheme]:s.plum,i=void 0!==t?t.t:50*Math.random();console.log(i),this.r=255*(e[0][0]+e[0][1]*i+e[0][2]*i*i+e[0][3]*i*i*i),this.g=255*(e[1][0]+e[1][1]*i+e[1][2]*i*i+e[1][3]*i*i*i),this.b=255*(e[2][0]+e[2][1]*i+e[2][2]*i*i+e[2][3]*i*i*i),this.a=.7}}toString(){return"rgba("+this.r.toFixed(4)+", "+this.g.toFixed(4)+", "+this.b.toFixed(4)+", "+this.a.toFixed(4)+")"}darken(t){this.r*=t,this.g*=t,this.b*=t}lighten(t){this.r=1-(1-this.r)*t,this.g=1-(1-this.g)*t,this.b=1-(1-this.b)*t}}function u(t,e){for(let i=0;i<t.length-1;i++)e(i,t[i],t[i+1])}function p(t){let e=0;return t.length>3&&u(t,function(t,i,n){e+=i.cross(n)/2}),e}function y(t,e){let i=0;return u(t,function(t,n,s){i+=(n[e]+s[e])*n.cross(s)/6}),i}class g extends Array{constructor(t){super(...t),this.push(this[0]),this.color=new d,this.area=p(this),this.centroid=function(t){if(t.length>2){let e=y(t,"x"),i=y(t,"y"),n=p(t);return new c(e/n,i/n)}console.error("centroid needs at least two points over the curve")}(this),this.type="Polygon"}scale(t){for(let e=0;e<this.length-1;e++)this[e].imult(t)}trans(t){for(let e=0;e<this.length-1;e++)this[e].iadd(t)}draw(t){t.fillStyle=this.color.toString(),console.log(t.fillStyle),t.beginPath(),t.moveTo(this[0].x,this[0].y);for(let e=0;e<this.length;e++)t.lineTo(this[e].x,this[e].y);t.closePath(),t.fill(),t.fillStyle="black",t.beginPath(),t.arc(this.centroid.x,this.centroid.y,10,0,2*Math.PI),t.fill()}splitBy(t){const{enter:e,exit:i,strokeIntersection:n}=function(t,e){let i=void 0,n=void 0;u(e,function(e,s,r){u(t,function(t,o,l){var h=function(t,e,i,n){let s=t.sub(i).cross(i.sub(n)),r=-t.sub(e).cross(t.sub(i)),o=t.sub(e).cross(i.sub(n)),l=s/o,h=r/o;return{p:t.add(e.sub(t).mult(l)),s:l,t:h}}(s,r,o,l);let a=h.t>0&&h.t<1,c=h.s<1&&h.s>0,d=h.s<1&&s.attr.head,u=h.s>0&&r.attr.tail;if(a&&(d||c||u)){let s={inter:h,stroEdge:e,polyEdge:t};if(i){if(n)return;n=s}else i=s}})});let s=[];if(void 0!==i&&void 0!==n){s.push(i.inter.p);for(let t=i.stroEdge+1;t<=n.stroEdge;t++)s.push(e[t]);s.push(n.inter.p)}return{enter:i,exit:n,strokeIntersection:s}}(this,t);let s,r;e.polyEdge<i.polyEdge?(s=e.polyEdge,r=i.polyEdge,n.reverse()):(s=i.polyEdge,r=e.polyEdge);let o=Array.from(this);return{innerSide:o.slice(s,r+1).concat(n),outerSide:o.slice(1,s).concat(n.reverse()).concat(o.slice(r))}}area(){return this.body.length>3?this.body.concat(this.body[0].copy()).part(2,1).map(t=>t[0].cross(t[1])/2).sum():0}}new class{constructor(t){this.textStyle={background:"transparent","z-index":2,height:"auto",resize:"none","-webkit-text-fill-color":"transparent",outline:"none"},this.textCodeStyle={position:"absolute",top:"0px",left:0,width:"550px","font-family":'"Inconsolata", "TheSansMono Office", "FiraSans Mono, monospace"',"font-size":"12px","letter-spacing":"-0.05em","line-height":"150%",padding:"10px",resize:"none",border:"none","border-radius":"5px","overflow-x":"scroll","overflow-y":"scroll"},this.edit=document.createElement("textarea"),this.edit.setAttribute("id","textedit"),this.edit.setAttribute("spellcheck","false"),this.edit.setAttribute("class","editor");for(let t in this.textStyle)this.edit.style[t]=this.textStyle[t];for(let t in this.textCodeStyle)this.edit.style[t]=this.textCodeStyle[t];t.appendChild(this.edit),this.preStyle={"white-space":"pre-wrap","word-wrap":"break-word"},this.codeStyle={background:"#fdf6e3","z-index":1};let e=document.createElement("pre");this.disp=document.createElement("code"),this.disp.setAttribute("id","textdisp"),this.disp.setAttribute("class","editor editor-display"),e.appendChild(this.disp),t.appendChild(e);for(let t in this.preStyle)e.style[t]=this.preStyle[t];for(let t in this.textCodeStyle)this.disp.style[t]=this.textCodeStyle[t];for(let t in this.codeStyle)this.disp.style[t]=this.codeStyle[t];this.init()}init(){window.addEventListener("keydown",function(t){var e,i,n,s,r,o;if("Tab"===t.key&&(t.preventDefault(),this.edit.value.split("\n"),e=this.edit,i="  ",r=e.value,o=e.ownerDocument,"number"==typeof e.selectionStart&&"number"==typeof e.selectionEnd?(n=e.selectionEnd,e.value=r.slice(0,n)+i+r.slice(n),e.selectionStart=e.selectionEnd=n+i.length):"undefined"!=o.selection&&o.selection.createRange&&(e.focus(),(s=o.selection.createRange()).collapse(!1),s.text=i,s.select())),"Enter"===t.key&&t.ctrlKey){let e=function(t){var e=t.split("\n").filter(t=>!t.match(/^\s*$/)),i="",n=[],s=0;for(let t=0;t<e.length;t++){for(var r=e[t].search(/\S|$/);n.length>0&&n[n.length-1].indent>=r;)i+=h(n),n.pop();s=0;for(var o=e[t];o.length>0;)switch(o[0]){case" ":n[n.length-1].comma?i+=", ":n[n.length-1].comma=!0,s+=o.search(/\S|$/),o=o.trim();break;case"@":i+="[",n.push({type:"[",indent:s,comma:!1}),s+=1,o=o.slice(1);break;case"#":i+="{",n.push({type:"{",indent:s,comma:!1}),s+=1,o=o.slice(1);break;case":":i+=":",n.push({type:":",indent:s}),s+=1,o=o.slice(1);break;case'"':var l=o.match(/"(?:\\"|[^"])*"/);if(!l)throw"Quoted string missing at Line: "+t;n.length>0&&":"==n[n.length-1].type&&n.pop(),s+=l[0].length,i+=o.slice(0,l[0].length),o=o.slice(l[0].length);break;default:var a=o.match(/[^\s:]*/);if(!a)throw"Simple string got some problem at Line: 1";n.length>0&&":"==n[n.length-1].type&&n.pop(),s+=a[0].length;var c=o.slice(0,a[0].length),d=parseFloat(c);i+=d||0==d?d:'"'+c+'"',o=o.slice(a[0].length)}}for(;n.length>0&&n[n.length-1].indent>=0;)i+=h(n),n.pop();return i}(this.edit.value),i=JSON.parse(e),n=function(t,e){return l(t,e,e).join("\n")}(i,120);this.edit.value=n,this.edit.focus(),t.target.dispatchEvent(new CustomEvent("interpret",{bubbles:!0,detail:i}))}else"Enter"===t.key&&t.ctrlKey}.bind(this)),this.edit.addEventListener("input",function(t){console.log("yaya"),this.edit.style.height=this.edit.scrollHeight;var e=this.edit.value;this.disp.innerHTML=a(e,"","color:#d33682;")+"\n "}.bind(this)),this.edit.innerText="@ ",this.disp.innerHTML=a("@ ","","color:#d33682;")+"\n ",this.edit.focus()}highlight(){}update(t){this.edit.value=t,this.highlight()}}(document.getElementById("editor"));let f=document.createElement("canvas"),m=f.getContext("2d"),x=window.devicePixelRatio;f.width=800,f.height=800,f.style.width=400,f.style.height=400,document.getElementById("canvas-container").appendChild(f),m.translate(f.width/2,f.height/2),m.scale(x,x);var b={root:new g([new c(1,1),new c(-1,1),new c(-1,-1),new c(1,-1)])};b.root.scale(200),b.stroke1=new class extends Array{constructor(t){super(...t),this[0].setAttr({head:!0}),this[this.length-1].setAttr({tail:!0}),this.color=new d,this.color.darken(.3),this.type="Stroke"}scale(t){for(let e=0;e<this.length;e++)this[e].imult(t)}draw(t){t.strokeStyle=this.color.toString(),t.lineWidth=5,t.beginPath(),t.moveTo(this[0].x,this[0].y);for(let e=0;e<this.length;e++)t.lineTo(this[e].x,this[e].y);t.stroke()}}([new c(0,2),new c(.1,.5),new c(-.1,-.5),new c(0,-2)]),b.stroke1.scale(80),function(t,e){const i=b[t],n=b[e],{innerSide:s,outerSide:r}=i.splitBy(n);delete b[t],b[t+"i"]=new g(s),b[t+"o"]=new g(r)}("root","stroke1"),function(t){for(let e in b)"Polygon"==b[e].type&&b[e].draw(t);for(let e in b)"Stroke"==b[e].type&&b[e].draw(t)}(m),console.log(b.rooti.type),document.addEventListener("interpret",function(t){console.log(t,"interpret")})}]);