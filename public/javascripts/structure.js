!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);class n{constructor(t,e){void 0===e?void 0===t?(this.x=0,this.y=0):(this.x=Math.cos(t*Math.PI/180),this.y=Math.sin(t*Math.PI/180)):(this.x=t,this.y=e)}add(t){return new n(this.x+t.x,this.y+t.y)}sub(t){return new n(this.x-t.x,this.y-t.y)}mult(t){return void 0===t.x?new n(this.x*t,this.y*t):new n(this.x*t.x,this.y*t.y)}head(t){return new n(Math.min(this.x,t.x),Math.min(this.y,t.y))}tail(t){return new n(Math.max(this.x,t.x),Math.max(this.y,t.y))}copy(){return new n(this.x,this.y)}}class s{constructor(t,e){void 0===e&&(e=new n),void 0===t&&(t=new n),this.head=t.copy(),this.tail=e.copy()}union(t){var e=this.head.head(t.head),i=this.tail.tail(t.tail);return new s(e,i)}copy(){return new s(this.head.copy(),this.tail.copy())}center(){return this.head.add(this.tail).mult(new n(.5,.5))}}class a{constructor(t){this.body=void 0===t?[]:t.map(t=>t.copy()),this.head=new n,this.box=new s,this.progs=[]}modify(t){void 0===t&&(t=this.progs);for(let e of t){for(let t in e)"ith"!==t&&"progs"!==t&&this[t](e[t]);void 0===e.ith?this.body.forEach(t=>t.modify(e.progs)):this.body[e.ith].modify(e.progs)}this.update()}update(){if(this.body.length>0&&(this.body[0].head=this.head.copy(),this.body[0].update(),this.box=this.body[0].box),console.log(this.box),this.body.length>1)for(let t=1;t<this.body.length;t++)try{this.body[t].head=this.body[t-1].tail.copy(),this.body[t].update(),this.tail=this.body[t].tail,this.box=this.box.union(this.body[t].box)}catch(t){}}translate(t){this.head.x+=t.x,this.head.y+=t.y}copy(){var t=new this.constructor;return t.body=this.body.map(t=>t.copy()),t.head=this.head.copy(),t}draw(t){for(let e of this.body)e.draw(t)}transCenter(){try{this.head=this.head.add(new n(300,300).sub(this.box.center()))}catch(t){console.error("transCenter",this.box)}this.update()}}function o(t,e){return[...Array(t).keys()].map((t,i)=>e(t,i))}class r extends a{constructor(t){super(),this.len=t.len,this.ang=t.ang,this.head=new n,this.tail=new n,this.box=new s,this.update()}copy(){return new r({len:this.len,ang:this.ang,head:this.head})}update(){var t=new n(this.ang);this.tail=this.head.add(t.mult(this.len));var e=this.head.head(this.tail),i=this.tail.tail(this.head);this.box=new s(e,i)}draw(t){t.beginPath(),t.moveTo(this.head.x,this.head.y),t.lineTo(this.tail.x,this.tail.y),t.stroke()}modify(t){void 0===t&&(t=this.progs);for(let e of t)switch(Object.keys(e)[0]){case"trans":this.head.x+=e.trans.x,this.head.y+=e.trans.y;break;case"rotate":this.ang+=e.rotate.theta;break;case"stretch":this.len*=e.stretch.ratio}this.update()}}class h extends a{constructor(t){super(void 0!=t?t.body.map(t=>new r(t)):[]),this.update()}at(t){var e,i=this.head.copy(),n=t*this.body.reduce((t,e)=>t+e.len,0),s=0;for(let t=0;t<this.body.length-1&&(e=this.body[t],s+=this.body[t].len,i=i.add(new Vec(e.ang).mult(e.len)),!(this.body[t+1].len+s>n));t++);return i=i.add(new Vec(e.ang).mult(n-s))}}class d extends a{constructor(t){super(t),this.update()}at(t,e){return this.body[e].at(t)}}function c(t,e,i){var n=function(t){return{start:t.selectionStart,end:t.selectionEnd}}(t),s=t.value;t.value=s.slice(0,n.start)+e+s.slice(n.start),function(t,e){setTimeout(function(){t.selectionStart=e,t.selectionEnd=e},1)}(t,n.start+i)}var l=document.getElementById("canvas"),y=document.getElementById("canvas").getContext("2d"),u=window.devicePixelRatio;l.style.width=l.width+"px",l.style.height=l.height+"px",l.width=l.width*u,l.height=l.height*u,y.scale(u,u),function(t){t.addEventListener("keypress",function(e){var i={"[":["[]",1],"'":['""',1],'"':['""',1],"{":["{}",1],Enter:["\n\n",1]};"Enter"===e.key&&e.ctrlKey?redrawRadical():e.key in i&&(e.preventDefault(),c(t,i[e.key][0],i[e.key][1]))}),t.focus()}(document.getElementById("stroke-list")),function(t){var e=o(20,(t,e)=>new r({len:10,ang:0}));for(let i=0;i<20;i++)e[i].progs=[{trans:{x:10*i,y:10*i}},{rotate:{theta:2*i}},{stretch:{ratio:i}}],e[i].modify(),e[i].draw(t,e[i].head);console.log(e)}(y),function(){var t={body:o(31,(t,e)=>({len:1/Math.sin(Math.PI/12),ang:6*e}))},e=[...Array(17).keys()].map((e,i)=>new h(t)),i=new d(e);i.progs=o(17,(t,e)=>({ith:e,progs:[{progs:[{rotate:{theta:360/17*e}}]}]})),i.modify(),i.transCenter();var n=document.getElementById("canvas").getContext("2d");i.draw(n);var s=i.box;n.rect(s.head.x,s.head.y,s.tail.x-s.head.x,s.tail.y-s.head.y),n.stroke()}()}]);